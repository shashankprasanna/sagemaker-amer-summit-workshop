<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta property="og:title" content="Getting Started with Amazon SageMaker" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://main.d2liw0uxeuzv0b.amplifyapp.com/" />
    <meta property="og:image" content="https://main.d2liw0uxeuzv0b.amplifyapp.com/images/setup/image002.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.59.0" />
    <meta name="description" content="Getting Started with Amazon SageMaker Studio">
<meta name="author" content="Shashank Prasanna">

    <link rel="shortcut icon" href="../../images/favicon.ico" type="image/x-icon" />
<link rel="icon" href="../../images/favicon.ico" type="image/x-icon" />

    {0xc000725600 0xc00052f8e0}
    <title>2.1 Data Preparation with Amazon SageMaker Studio Notebook :: Getting Started with Amazon SageMaker Studio</title>

    
    <link href="../../css/nucleus.css?1620810688" rel="stylesheet">
    <link href="../../css/fontawesome-all.min.css?1620810688" rel="stylesheet">
    <link href="../../css/hybrid.css?1620810688" rel="stylesheet">
    <link href="../../css/featherlight.min.css?1620810688" rel="stylesheet">
    <link href="../../css/perfect-scrollbar.min.css?1620810688" rel="stylesheet">
    <link href="../../css/auto-complete.css?1620810688" rel="stylesheet">
    <link href="../../css/theme.css?1620810688" rel="stylesheet">
    <link href="../../css/hugo-theme.css?1620810688" rel="stylesheet">
    <link href="../../css/jquery-ui.min.css?1620810688" rel="stylesheet">
    
      <link href="../../css/theme-mine.css?1620810688" rel="stylesheet">
    

    <script src="../../js/jquery-3.3.1.min.js?1620810688"></script>
    <script src="../../js/jquery-ui-1.12.1.min.js?1620810688"></script>


    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/amp/2_sagemaker_autopilot/dataprep_studio_notebook.html">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="../../" title="Go home"><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 30" width="60%" style="padding:20px 0px;"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg></a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../../js/lunr.min.js?1620810688"></script>
<script type="text/javascript" src="../../js/auto-complete.js?1620810688"></script>
<script type="text/javascript">
    
        var baseurl = "";
    
</script>
<script type="text/javascript" src="../../js/search.js?1620810688"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/0_introduction.html" title="Workshop Interface Overview" class="dd-item 
        
        
        
        ">
      <a href="../../0_introduction.html">
          <i class="fa fa-film" aria-hidden="true"></i> Workshop Interface Overview
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/1_setup.html" title="1. Getting started" class="dd-item 
        
        
        
        ">
      <a href="../../1_setup.html">
          1. Getting started
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/amp/1_setup/login_aws_account.html" title="1.1 Login to your temporary workshop AWS Account" class="dd-item ">
        <a href="../../amp/1_setup/login_aws_account.html">
        1.1 Login to your temporary workshop AWS Account
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/amp/1_setup/download_workshop_content.html" title="1.2 Download workshop content" class="dd-item ">
        <a href="../../amp/1_setup/download_workshop_content.html">
        1.2 Download workshop content
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2_sagemaker_autopilot.html" title="2. AutoML with SageMaker AutoPilot" class="dd-item 
        parent
        
        
        ">
      <a href="../../2_sagemaker_autopilot.html">
          2. AutoML with SageMaker AutoPilot
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/amp/2_sagemaker_autopilot/dataprep_studio_notebook.html" title="2.1 Data Preparation with Amazon SageMaker Studio Notebook" class="dd-item active">
        <a href="../../amp/2_sagemaker_autopilot/dataprep_studio_notebook.html">
        2.1 Data Preparation with Amazon SageMaker Studio Notebook
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/amp/2_sagemaker_autopilot/autopilot-workflow.html" title="2.2 Use SageMaker AutoPilot to find the best models" class="dd-item ">
        <a href="../../amp/2_sagemaker_autopilot/autopilot-workflow.html">
        2.2 Use SageMaker AutoPilot to find the best models
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3_build-train-tune-deploy.html" title="3. Build, train and tune models with SageMaker built-in algorithms" class="dd-item 
        
        
        
        ">
      <a href="../../3_build-train-tune-deploy.html">
          3. Build, train and tune models with SageMaker built-in algorithms
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/amp/3_build-train-tune-deploy/train_xgboost_model.html" title="3.1 Train, tune and deploy an XGBoost model" class="dd-item ">
        <a href="../../amp/3_build-train-tune-deploy/train_xgboost_model.html">
        3.1 Train, tune and deploy an XGBoost model
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4_clean-up.html" title="6. Clean up resources" class="dd-item 
        
        
        
        ">
      <a href="../../4_clean-up.html">
          6. Clean up resources
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/amp/4_clean-up/cleanup.html" title="Delete all resources" class="dd-item ">
        <a href="../../amp/4_clean-up/cleanup.html">
        Delete all resources
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/appendix.html" title="Appendix" class="dd-item 
        
        
        
        ">
      <a href="../../appendix.html">
          Appendix
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/amp/appendix/docs.html" title="Documentation resources" class="dd-item ">
        <a href="../../amp/appendix/docs.html">
        Documentation resources
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/amp/appendix/resources.html" title="Technical papers" class="dd-item ">
        <a href="../../amp/appendix/resources.html">
        Technical papers
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/amp/appendix/blogposts_videos.html" title="Blogposts and videos" class="dd-item ">
        <a href="../../amp/appendix/blogposts_videos.html">
        Blogposts and videos
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/amp/appendix/example-profiler-report.html" title="Example profiler report" class="dd-item ">
        <a href="../../amp/appendix/example-profiler-report.html">
        Example profiler report
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='../../amp/'>Welcome to Getting started with Amazon SageMaker Workshop at AMER Summit</a> > <a href='../../2_sagemaker_autopilot.html'>2. AutoML with SageMaker AutoPilot</a> > 2.1 Data Preparation with Amazon SageMaker Studio Notebook
          
        
          
        
          
        
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#how-to-run-this-section">How to run this section</a></li>
<li><a href="#data-preparation-with-sagemaker-studio-notebook">Data preparation with SageMaker Studio Notebook</a>
<ul>
<li>
<ul>
<li><a href="#import-required-libraries">Import required libraries</a></li>
<li><a href="#make-sure-that-you-are-running-the-latest-version-of-the-amazon-sagemaker-sdk">Make sure that you are running the latest version of the Amazon SageMaker SDK</a></li>
<li><a href="#save-variables-using-store-to-make-variables-persistent-across-notebooks-and-notebook-restarts">Save variables using <code>%store</code> to make variables persistent across notebooks and notebook restarts</a></li>
<li><a href="#create-boto3-session-and-sagemaker-session">Create boto3 session and sagemaker session</a></li>
<li><a href="#download-the-credit-card-default-dataset-locally-to-data-folder">Download the Credit card default dataset locally to <code>/data/</code> folder</a></li>
<li><a href="#check-if-the-dataset-has-null-values">Check if the dataset has Null values</a></li>
<li><a href="#check-the-dataset-for-gender-bias">Check the dataset for gender bias</a></li>
<li><a href="#check-if-the-dataset-is-imbalanced">Check if the dataset is imbalanced</a></li>
<li><a href="#plot-the-client-age-distribution">Plot the client age distribution</a></li>
</ul></li>
<li><a href="#upload-data-to-amazon-s3-for-further-analysis-and-processing-with-amazon-sagemaker-data-wrangler">Upload data to Amazon S3 for further analysis and processing with Amazon SageMaker Data Wrangler</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>2.1 Data Preparation with Amazon SageMaker Studio Notebook</h1>
          

        




<h2 id="how-to-run-this-section">How to run this section</h2>

<p>To run this section of the workshop, read the instruction above each code cell, copy the code and paste it in the Jupyter notebook cell, and click run to execute the code.</p>

<p><img src="../../images/dataprep/instructions.png" alt="" /></p>

<h2 id="data-preparation-with-sagemaker-studio-notebook">Data preparation with SageMaker Studio Notebook</h2>

<h4 id="import-required-libraries">Import required libraries</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Importing required libraries.</span>
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> seaborn <span style="color:#f92672">as</span> sns <span style="color:#75715e">#visualisation</span>
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt <span style="color:#75715e">#visualisation</span>
<span style="color:#f92672">%</span>matplotlib inline
sns<span style="color:#f92672">.</span>set(color_codes<span style="color:#f92672">=</span>True)

<span style="color:#f92672">import</span> boto3
<span style="color:#f92672">import</span> sagemaker</code></pre></div>
<h4 id="make-sure-that-you-are-running-the-latest-version-of-the-amazon-sagemaker-sdk">Make sure that you are running the latest version of the Amazon SageMaker SDK</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Update SageMaker SDK if necessary</span>
<span style="color:#66d9ef">if</span> int(sagemaker<span style="color:#f92672">.</span>__version__<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;.&#39;</span>)[<span style="color:#ae81ff">0</span>]) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">2</span>:
    <span style="color:#960050;background-color:#1e0010">!</span>pip install sagemaker<span style="color:#f92672">==</span><span style="color:#ae81ff">2.24</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Updating SageMakerVersion. Please restart the kernel&#34;</span>)
<span style="color:#66d9ef">else</span>:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;SageMaker SDK version is good&#34;</span>)</code></pre></div>
<h4 id="save-variables-using-store-to-make-variables-persistent-across-notebooks-and-notebook-restarts">Save variables using <code>%store</code> to make variables persistent across notebooks and notebook restarts</h4>

<p>Run the cell below to load any prevously created variables. You should see a print-out of the existing variables. If you don&rsquo;t see anything printed then it&rsquo;s probably the first time you are running the notebook!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">%</span>store <span style="color:#f92672">-</span>r
<span style="color:#f92672">%</span>store</code></pre></div>
<h4 id="create-boto3-session-and-sagemaker-session">Create boto3 session and sagemaker session</h4>

<p>We&rsquo;ll use the boto3 and sagemaker session to get the default S3 bucket to save your datasets and training jobs.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">boto_session <span style="color:#f92672">=</span> boto3<span style="color:#f92672">.</span>Session()
region <span style="color:#f92672">=</span> boto_session<span style="color:#f92672">.</span>region_name
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Region = {}&#34;</span><span style="color:#f92672">.</span>format(region))

sagemaker_boto_client <span style="color:#f92672">=</span> boto_session<span style="color:#f92672">.</span>client(<span style="color:#e6db74">&#39;sagemaker&#39;</span>)

sagemaker_session <span style="color:#f92672">=</span> sagemaker<span style="color:#f92672">.</span>session<span style="color:#f92672">.</span>Session(
    boto_session<span style="color:#f92672">=</span>boto_session,
    sagemaker_client<span style="color:#f92672">=</span>sagemaker_boto_client)


default_bucket <span style="color:#f92672">=</span> sagemaker_session<span style="color:#f92672">.</span>default_bucket()  <span style="color:#75715e"># Alterantively you can use our custom bucket here.</span>
prefix <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;sagemaker-tutorial&#39;</span>  <span style="color:#75715e"># use this prefix to store all files pertaining to this workshop.</span>
data_prefix <span style="color:#f92672">=</span> prefix <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;/data&#39;</span>

<span style="color:#f92672">%</span>store default_bucket
<span style="color:#f92672">%</span>store prefix
<span style="color:#f92672">%</span>store data_prefix</code></pre></div>
<h4 id="download-the-credit-card-default-dataset-locally-to-data-folder">Download the Credit card default dataset locally to <code>/data/</code> folder</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">local_data_dir <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;../data&#39;</span>
<span style="color:#960050;background-color:#1e0010">!</span>mkdir <span style="color:#960050;background-color:#1e0010">$</span>local_data_dir
<span style="color:#960050;background-color:#1e0010">!</span>wget <span style="color:#f92672">-</span>O <span style="color:#f92672">../</span>data<span style="color:#f92672">/</span>default_of_credit_card<span style="color:#f92672">.</span>xls  https:<span style="color:#f92672">//</span>archive<span style="color:#f92672">.</span>ics<span style="color:#f92672">.</span>uci<span style="color:#f92672">.</span>edu<span style="color:#f92672">/</span>ml<span style="color:#f92672">/</span>machine<span style="color:#f92672">-</span>learning<span style="color:#f92672">-</span>databases<span style="color:#f92672">/</span><span style="color:#ae81ff">00350</span><span style="color:#f92672">/</span>default<span style="color:#f92672">%</span><span style="color:#ae81ff">20</span>of<span style="color:#f92672">%</span><span style="color:#ae81ff">20</span>credit<span style="color:#f92672">%</span><span style="color:#ae81ff">20</span>card<span style="color:#f92672">%</span><span style="color:#ae81ff">20</span>clients<span style="color:#f92672">.</span>xls
<span style="color:#f92672">%</span>store local_data_dir</code></pre></div>
<h4 id="check-if-the-dataset-has-null-values">Check if the dataset has Null values</h4>

<p>If the result is not 0, we need to think of imputation strategies. Imputation is the process of replacing missing values with a probable value. This is often the mean, median or mode of the column, but there are also several other imputation approaches.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># load data as dataframe</span>
local_data_path <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#39;{local_data_dir}/default_of_credit_card.xls&#39;</span>

df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(local_data_path, header<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
df<span style="color:#f92672">.</span>head()</code></pre></div>
<p>You should notice that the dataset has no missing values, when you run the command below</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#39;Total number of missing values in the data: {df.isnull().sum().sum()}&#39;</span>)</code></pre></div>
<h4 id="check-the-dataset-for-gender-bias">Check the dataset for gender bias</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># plot the bar graph customer gender</span>
df[<span style="color:#e6db74">&#39;SEX&#39;</span>]<span style="color:#f92672">.</span>value_counts(normalize<span style="color:#f92672">=</span>True)<span style="color:#f92672">.</span>plot<span style="color:#f92672">.</span>bar()
plt<span style="color:#f92672">.</span>xticks([<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#e6db74">&#39;Male&#39;</span>, <span style="color:#e6db74">&#39;Female&#39;</span>])</code></pre></div>

<div class="notices info" ><p>STOP: What do you see in the resulting graph? is the gender equally distributed?</p>
</div>


<h4 id="check-if-the-dataset-is-imbalanced">Check if the dataset is imbalanced</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#e6db74">&#39;default payment next month&#39;</span>]<span style="color:#f92672">.</span>value_counts(normalize<span style="color:#f92672">=</span>True)<span style="color:#f92672">.</span>plot<span style="color:#f92672">.</span>bar()
plt<span style="color:#f92672">.</span>xticks([<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#e6db74">&#39;Not Default&#39;</span>, <span style="color:#e6db74">&#39;Default&#39;</span>])</code></pre></div>

<div class="notices info" ><p>STOP: What do you see in the resulting graph? Is the dataset balanced? What is the ratio of the number of defaulters to non-defaulters? Should this affect your ML approach?</p>
</div>


<h4 id="plot-the-client-age-distribution">Plot the client age distribution</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># plot the age distribution</span>
plt<span style="color:#f92672">.</span>hist(df[<span style="color:#e6db74">&#39;AGE&#39;</span>], bins<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Clients Age Distribution&#39;</span>)</code></pre></div>

<div class="notices info" ><p>STOP: Do you see a pattern? Does a certain age group have a higher probability of defaulting vs. other?</p>
</div>


<h3 id="upload-data-to-amazon-s3-for-further-analysis-and-processing-with-amazon-sagemaker-data-wrangler">Upload data to Amazon S3 for further analysis and processing with Amazon SageMaker Data Wrangler</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">local_raw_path <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#39;{local_data_dir}/dataset.csv&#39;</span>
df<span style="color:#f92672">.</span>to_csv(local_raw_path, index<span style="color:#f92672">=</span>False)

response <span style="color:#f92672">=</span> sagemaker_session<span style="color:#f92672">.</span>upload_data(local_raw_path,
                                         bucket<span style="color:#f92672">=</span>default_bucket,
                                         key_prefix<span style="color:#f92672">=</span>data_prefix)
<span style="color:#66d9ef">print</span>(response)

s3_raw_data <span style="color:#f92672">=</span> response

<span style="color:#f92672">%</span>store s3_raw_data
<span style="color:#f92672">%</span>store local_raw_path</code></pre></div>

<div class="notices tip" ><p>Save your notebook with a meaningful name by navigating to <code>File &gt; Rename Notebook</code> and entering a name of your choice.</p>
</div>



<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


        
            <a class="nav nav-prev" href="../../2_sagemaker_autopilot.html" title="2. AutoML with SageMaker AutoPilot"> <i class="fas fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="../../amp/2_sagemaker_autopilot/autopilot-workflow.html" title="2.2 Use SageMaker AutoPilot to find the best models" style="margin-right: 0px;"><i class="fas fa-chevron-right"></i></a>
        
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../../js/clipboard.min.js?1620810688"></script>
    <script src="../../js/perfect-scrollbar.min.js?1620810688"></script>
    <script src="../../js/perfect-scrollbar.jquery.min.js?1620810688"></script>
    <script src="../../js/jquery.sticky.js?1620810688"></script>
    <script src="../../js/featherlight.min.js?1620810688"></script>
    <script src="../../js/highlight.pack.js?1620810688"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../../js/modernizr.custom-3.6.0.js?1620810688"></script>
    <script src="../../js/learn.js?1620810688"></script>
    <script src="../../js/hugo-learn.js?1620810688"></script>

    <link href="../../mermaid/mermaid.css?1620810688" type="text/css" rel="stylesheet" />
    <script src="../../mermaid/mermaid.min.js?1620810688"></script>
    <script>
	var config = {
        startOnLoad:true,
        flowchart:{
	    curve:'basis'
        }
      };
        mermaid.initialize(config);
    </script>
    

<script type="text/javascript" src="https://eventbox.dev/js/injectOverlay.js"></script>
  </body>
</html>

